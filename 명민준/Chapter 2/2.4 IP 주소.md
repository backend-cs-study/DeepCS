# 2.4 IP 주소

## 2.4.1 ARP (Address Resolution Protocol, 주소 결정 프로토콜)

* 컴퓨터 간의 통신은 흔히 IP 주소를 기반으로 하지만, 실제로는 ARP를 통해 MAC 주소를 찾아 통신합니다.
* ARP는 IP 주소로부터 MAC 주소를 구하는 프로토콜로, IP와 MAC 주소 간의 다리 역할을 합니다.
* ARP를 통해 가상 주소인 IP 주소를 실제 주소인 MAC 주소로 변환하며,
  반대로 RARP(Reverse Address Resolution Protocol)를 통해 MAC 주소를 IP 주소로 변환할 수 있습니다.
* 장치 A가 ARP Request 브로드캐스트를 보내 특정 IP 주소에 해당하는 MAC 주소를 요청하고,
  해당 주소를 가진 장치 B가 ARP Reply 유니캐스트를 통해 응답합니다.

> `브로드캐스트`: 네트워크에 연결된 모든 호스트에 전송하는 방식
> `유니캐스트`: 특정 호스트에게 1:1로 전송하는 방식

---

## 2.4.2 홉바이홉 통신

* IP 주소를 통해 통신하는 과정을 의미합니다.
* '홉(hop)'은 통신망에서 각 패킷이 여러 개의 라우터를 건너가는 모습을 비유적으로 표현한 것입니다.
* 통신 장치에 있는 라우팅 테이블을 통해 시작 IP에서 목적지까지 이동하며 최종 도달합니다.

### 라우팅 테이블 (Routing Table)

* 송신지에서 수신지까지 도달하기 위해 사용됩니다.
* 라우터에 저장된 목적지와 해당 목적지까지 가기 위한 다음 라우터 정보가 포함되어 있습니다.

### 게이트웨이 (Gateway)

* 서로 다른 통신망이나 프로토콜을 사용하는 네트워크 간 통신을 가능하게 하는 장치입니다.
* 사용자 인터넷 접속 시 여러 게이트웨이를 거칩니다.
* 게이트웨이는 서로 다른 프로토콜 간 변환도 담당합니다.

```bash
# 라우팅 테이블/게이트웨이 확인 명령어
netstat -r   # Windows
netstat -rn  # Linux
```

---

## 2.4.3 IP 주소 체계

### IPv4와 IPv6

* **IPv4**: 32비트, 8비트 단위 점 표기 (예: `192.168.0.1`)
* **IPv6**: 128비트, 16비트 단위 콜론 표기 (예: `2001:db8::ff00:42:8329`)

### 클래스 기반 할당 방식 (Classful Network Addressing)

: IP 주소를 A, B, C, D, E 클래스로 구분하여 네트워크/호스트 비율 할당

| 클래스 | 구분비트 | IP 범위                        | 용도       |
| --- | ---- | ---------------------------- | -------- |
| A   | 0    | 0.0.0.0 \~ 127.255.255.255   | 대규모 네트워크 |
| B   | 10   | 128.0.0.0 \~ 191.255.255.255 | 중규모 네트워크 |
| C   | 110  | 192.0.0.0 \~ 223.255.255.255 | 소규모 네트워크 |
| D   | 1110 | 224.0.0.0 \~ 239.255.255.255 | 멀티캐스트 전용 |
| E   | 1111 | 240.0.0.0 \~ 255.255.255.255 | 실험용 (예약) |

* 네트워크의 첫 주소는 네트워크 식별용으로 사용되며, 마지막 주소는 브로드캐스트용으로 사용됩니다.
* 중간의 나머지 주소들이 실제 호스트에게 할당됩니다.

> 예: 클래스 A `12.0.0.0` 네트워크는 `12.0.0.1 ~ 12.255.255.254`까지 호스트 주소 할당 가능

❗ 클래스 방식은 낭비되는 주소가 많다는 단점이 있어 DHCP, NAT 방식으로 개선되었습니다.

---

## DHCP (Dynamic Host Configuration Protocol)

* IP 주소 및 네트워크 정보를 **자동으로 할당**하는 프로토콜입니다.
* 사용자가 별도로 설정하지 않아도 라우터나 게이트웨이에서 자동으로 IP가 부여됩니다.

---

## NAT (Network Address Translation)

* 내부 IP ↔ 외부 공인 IP 주소를 **서로 변환**하는 방식입니다.
* IPv4 주소 부족 문제를 해결하기 위해 도입되었습니다.
* 하나의 공인 IP 주소를 여러 장치가 공유할 수 있습니다.

> 예: 내부 `192.168.0.x` → NAT → 외부 `121.165.151.200`

### NAT 관련 소프트웨어 예시

* ICS (산업 제어 시스템)
* RRAS (라우팅 및 원격 액세스 서비스)
* Netfilter (리눅스 커널 기반 프레임워크)

### 공유기와 NAT

* 여러 대의 호스트가 하나의 공인 IP를 공유하기 위해 NAT 사용

### NAT 보안 효과

* 내부 IP와 외부 IP를 분리하여 **보안 향상** 효과 있음

### NAT 단점

* 동시에 여러 사용자가 인터넷에 접속할 경우 속도 저하 가능성 있음
