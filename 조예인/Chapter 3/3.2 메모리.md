# 3.2 메모리
- CPU는 그저 '메모리'에 올라와 있는 프로그램의 명령어들을 실행할 뿐임

# 3.2.1 메모리 계층
- 레지스터, 캐시, 메모리, 저장장치

✔️ 메모리 계층 <br>
- 레지스터 : CPU 안에 있 작은 메모리, 휘발성, 속도 가장 빠름, 기억 용량이 가장 적음
- 캐시: L1, L2 캐시를 지칭, 휘발성, 속도 빠름, 기역 용량이 적음. 참고로 L3 캐시도 있음
- 주기억장치 : RAM을 가리킴, 휘발성, 속도 보통, 기역 용량이 보통
- 보조기억장치 : HDD, SSD을 일컬음, 비휘발성, 속도 낮음, 기역 용량 많음
<br><br>
- 램은 하드디스크로부터 일정량의 데이터를 복사해서 임시 저장하고
  - 이를 필요 시마다 CPU에 빠르게 전달하는 역할
- 계층 위로 올라갈수록 가격은 비싸짐
  - 특징 : 용량은 작아지고 속도는 빨라짐
- 이러한 계층이 있는 이유 : 경제성과 캐시 때문
- ex) 16GB RAM은 8만원이면 삼
  - 하지만 16GM SSD는 훨씬 더 싼 가격에 살 수 있음
    - 이러한 경제성 때문에 계층을 두어 관리함
- 이러한 계층 구조는 일상생활에서 경험 가능
  - 계임을 실행하다 보면 '로딩중'이라는 메시지 나오는 것 볼 수 있음
    - 이는 하드디스크 또는 인터넷에서 데이터를 읽어 RAM으로 전송하는 과정이 아직 끝나지 않음을 의미함

## 캐시(cache)
- 데이터를 미리 복사해 놓는 임시 저장소이자
  - 빠른 장치와 느린 장치에서 속도 차이에 따른 병목 현상을 줄이기 위한 메모리
- 이를 통해 데이터를 접근하는 시같이 오래 걸리는 경우를 해결하고
  - 무언가를 다시 계산하는 시간을 절약 가능
- 실제로 메모리와 CPU 사이의 속도 차이가 너무 크기 때문에 그 중간에 레지스터 계층을 둬서 속도 차이를 해결함
  - 캐싱 계층 : 속도 차이를 해결하기 위해 계층과 계층 사이에 있는 계층
    - ex) 캐시 메모리와 보조기억장치 사이에 있는 주기억장치를 보조기억장치의 캐싱 계층이라고 할 수 있음

### 지역성의 원리
- 캐시 계층을 두는 것 말고 캐시를 직접 설정할 때는 어떻게 해야 할까요?
  - 자주 사용하는 데이터를 기반으로 설정해야 함
    - 근거 : 지역성

#### 시간 지역성(temporal locality)
- 최근 사용한 데이터에 다시 접근하려는 특성을 말함
- ex) for 반복문으로 이루어진 코드 안의 변수 i에 계속해서 접근이 이루어짐
- 여기서 데이터는 변수 i이고 최근에 사용했기 때문에 계속 접근해서 +1을 연이어 하는 것을 볼 수 있음

#### 공간 지역성(spatial locality)
- 최근 접근한 데이터를 일고 있는 공간이나 그 가까운 공간에 접근하는 특성
- 공간을 나타내는 배열 arr의 각 요소들에 i가 할당되며
  - 해당 배열에 연속적으로 접근함
  
## 캐시히트와 캐시미스
- 캐시히트 : 캐시에서 원하는 데이터를 찾음
- 캐시미스 : 해당 데이터가 캐시에 없다면 주메모리로 가서 데이터를 찾아오는 것
- 캐시히트를 하게되면 해당 데이터를 제어장치를 거쳐 가져오게 됨
  - 캐시히트의 경우 위치도 가깝고 CPU 내부 버스를 기반으로 작동하기 때문에 빠름
  - 반면에 캐시미스가 발생되면 메모리에서 가져오게 되는데,
    - 이는 시스템 버스를 기반으로 작동하기 때문에 느림

### 캐시매핑
- 캐시가 히트되기 위해 매핑하는 방법
- CPU의 레지스터와 주 메모리(RAM) 간에 데이터를 주고받을 때를 기반으로 설명함
- 레지스터는 주 메모리에 비하면 굉장히 작고 주 메모리는 굉장히 크기 때문에
  - 작은 레지스터가 캐시 계층으로써 역할을 잘 해주려면 이 매핑을 어떻게 하느냐가 중요함

✔️ 캐시매핑 분류 <br>
- 직접 매핑(directed mapping) : 메모리가 1-100이 있고 캐시가 1-10이 있다면 1:1-10, 2:1-20...
  - 이런 식으로 매핑하는 것. 처리가 빠르지만 충돌 발생이 잦음
- 연관 매핑(associative mapping) : 순서를 일치시키지 않고 관련 있는 캐시와 메모리를 매핑함
  - 충돌이 적지만 모든 블록을 탐색해야 해서 속도가 느림
- 집합 연관 매핑(set associative mapping) : 직접 매핑과 연관 매핑을 합쳐 놓은 것
  - 순서는 일치시키지만 집합을 둬서 저장하며 블록화되어 있기 때문에 검색을 좀 더 효율적
  - ex) 메모리가 1-100이 있고 캐시가 1-10이 있다면 캐시 1-5에는 1-50의 데이터를 무작위로 저장시키는 것

### 웹 브라우저의 캐시
- 소프트웨어적인 대표적인 캐시로는 웹 브라우저의 작은 저장소 쿠키, 로컬 스토리지, 세션 스토리지가 있음
- 보통 사용자의 커스텀한 정보나 인증 모듈 관련 사항들을 웹 브라우저에 저장해서
  - 추후 서버에 요청할 때 자신을 나타내는 아이덴티티나 중복 요청 방지를 위해 쓰이며 오리진(origin)에 종속됨

#### 쿠키
- 만료기한이 있는 키-값 저장소
- same site 옵션을 strict로 설정하지 않았을 경우 다른 도메인에서 요청했을 때 자동 전송되며,
  - 4KB까지 데이터를 저장할 수 있고 만료기한을 정할 수 있음
- 쿠키를 설정할 때는 document.cookie로 쿠키를 볼 수 없게 httponly 옵션을 거는 것이 중요하며,
  - 클라이언트 또는 서버에서 만료기한 등을 정할 수 있는데 보통 서버에서 만료기한을 정함

#### 로컬 스토리지
- 만료기한이 없는 키-값 저장소
- 5MB까지 저장할 수 있으며 웹 브라우저를 닫아도 유지됨
- HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없음
  - 클라이언트에서만 수정 가능

#### 세션 스토리지
- 만료기한이 없는 키-값 저장소
- 탭 단위로 세션 스토리지를 생성하며, 탭을 닫을 때 해당 데이터가 삭제됨
- 5MB까지 저장할 수 있으며 
  - HTML5를 지원하지 않는 웹 브라우저에서는 사용할 수 없음
    - 클라이언트에서만 수정 가능

### 데이터베이스의 캐싱 계층
- 참고 : 데이터베이스 시스템을 구축할 때도 메인 데이터베이스 위에 레디스(redis) 데이터베이스 계층을 '캐싱 계층'으로 둬서 성능을 향상시키기도 함

---
# 3.2.2 메모리 관리

## 가상 메모리

✔️용어 <br>
- 

### 스와핑

### 페이지 폴트

✔️용어 <br>
- 

## 스레싱

### 작업 세트

### PFF


## 메모리 할당

### 연속 할당


#### 고정 분할 방식


#### 가변 분할 방식

✔️용어 <br>
- 

### 불연속 할당

#### 페이징

#### 세그멘테이션

#### 페이지드 세그멘테이션


## 페이지 교체 알고리즘

### 오프라인 알고리즘

### FIFO

### LRU

#### NUR


### LFU

---
## ✅ 기본 질문과 답변



---
## ✅ 심화 질문과 답변
