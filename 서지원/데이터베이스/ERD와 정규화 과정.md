# Chapter4.2 ERD와 정규화 과정

<br>

# 📚 목차

> **[1. ERD의 중요성](#erd의-중요성)**
>
> **[2. 예제로 배우는 ERD](#예제로-배우는-erd)**
>
> **[3. 정규화 과정](#정규화-과정)**

<br>


>  **🔎 ERD(Entity Relationship Diagram)**
> 
> 데이터베이스를 구축할 때 가장 기초적인 뼈대 역할을 하며, Relationship간의 관계를 정의한 것 


## ERD의 중요성

시스템의 요구사항을 기반으로 작성되고 ERD를 기반으로 데이터베이스를 구축한다. 

> **💡 구축 후에도 `디버깅` or `비즈니스 프로세스` 재설계가 필요한 경우에 설계도 역할을 담당하기도 한다.** 

<br>

**⚠️ ERD는 관계형 구조로 표현할 수 있는 데이터를 구성하는데 유용하지만 `비정형 데이터`를 충분히 표현할 수 없는 단점이 있다.** 

> 🔎 **비정형 데이터**
> 
> **비구조화된 데이터**, 미리 <ins>정의된 데이터 모델이 없거나</ins> 미리 정의된 방식으로 <ins>정리되지 않은 정보<ins>

<br>

## 예제로 배우는 ERD

> 📌 **199 ~ 200 page 참고**

### 승원 영업부서의 ERD

### 무무오브레전드의 ERD

<br>

##  정규화 과정

릴레이션 간의 **잘못된 종속 관계로 인해 데이터베이스 이상 현상**이 일어나서 이를 `해결`하거나 **저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러개로 분리**하는 과정

> 💡 **데이터베이스 이상 현상**
> 
> - 데이터 삽입 시 하나의 필드가 NULL이 되면 안되는데 NULL이 되어 삽입하기 어려운 상황
> - 오직 1개의 등급만 가져야 하는데 여러개의 등급이 가져지는 상황

<br>

- 정규화된 정도는 (**NF, Normal Form**)으로 표현한다.


- `기본 정규형`인 제 1, 2, 3정규형, `보이스/코드 정규형`, `고급 정규형`인 4, 5정규형이 있다. 

<br>

### 정규형의 원칙

- 자료의 **중복성은 감소**


- `독립적인 관계`는 **별개의 릴레이션**으로 표현


- **각각의 릴레이션은 독립적인 표현**이 가능해야한다. 

<br>

### 제 1정규형 (1NF)

**모든 도메인**은 더 이상 분해될 수 없는 `원자 값만으로 구성`되어야 한다. 

![Image](https://github.com/user-attachments/assets/27b72379-928a-4e89-8d1b-de3f319487be)

수강명, 성취도 모두 2개 이상의 값을 가지는 집합으로 되어있다. **[반복 집합 제거 필요]**

<br>

![Image](https://github.com/user-attachments/assets/a067737e-a1c3-40ff-bc1c-6066c30ba6c8)

<br>

### 제 2정규형 (2NF)

릴레이션이 제1정규형 상태이고 **부분 함수의 종속성을 제거한 형태**를 의미한다. 

> **💡부분 함수의 종속성** 
> 
> 각 필드(=기본키가 아닌 컬럼)는 "기본키 전체"를 알아야만 값이 정해지는 구조

![Image](https://github.com/user-attachments/assets/a067737e-a1c3-40ff-bc1c-6066c30ba6c8)

<br>

![Image](https://github.com/user-attachments/assets/106e437f-8469-45e2-8818-1a1d642d539f)

<br>

### 제 3정규형 (3NF)

제 2정규형이고 기본키가 아닌 **모든 속성이 이행적 함수 종속을 만족하지 않는 상태** 

> **💡 이행적 함수 종속**
> 
> A ➡️ B, B ➡️ C가 존재하면 `A ➡️ C가 성립`하는데, <ins>집합 C가 집합 A에 이행적으로 함수 종속</ins>되었다고 한다. 


![Image](https://github.com/user-attachments/assets/e5d856a1-2706-4924-8e6d-e1225c158086)

**분리가 필요한 상태**

<br>

![Image](https://github.com/user-attachments/assets/b28dbe09-91d8-4b00-ad0d-8ca4da6889ad)

<br>

### 보이스/코드 정규형 (BCNF)

제 3정규형이고 `결정자`가 후보키가 아닌 **함수 종속 관계를 제거**하여 릴레이션의 함수 종속 관계에서 <ins>모든 결정자가 후보키인 상태

| 용어        | 뜻                                            |
| --------- |----------------------------------------------|
| **결정자**   | 어떤 값을 결정해주는 속성 (예: `A ➝ B`에서 A가 결정자, B가 종속자) |
| **함수 종속** | A ➝ B: A를 알면 B가 결정됨                          |
| **후보키**   | 유일성과 최소성을 만족하는 키 (기본키가 될 수 있는 애들)            |

**[예시 상황]**

- 각 수강명에 대해 `한 학생`은 **오직 한 강사의 강의**만 수강
- 각 `강사`는 **한 수강명**만 담당
- `한 수강명`은 **여러 강사가 담당 가능**

<br>

정규화는 성능이 좋아질 수도 나빠질 수도 있다. 

➡️ **쿼리로 조인하는 경우** 오히려 느려질 수 있음

따라서 서비스에 따라 정규화 또는 비정규화 과정을 진행해야한다. 
